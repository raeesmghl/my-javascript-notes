<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xhr post request</title>
</head>
<body>


    <button type="button" id="btn">request</button>


    
    <script>

            let btn = document.querySelector('#btn');


            // btn.addEventListener('click', clickEventFunc);

        function clickEventFunc() {
            // let username = prompt('enter your user name (you want to post)')||'raees';
            // let interest = prompt('enter your user interest (you want to post)')||'coding';
            
            let xhr = new XMLHttpRequest();    // create xhr object
            let url = 'https://jsonplaceholder.typicode.com/posts';   // url stored in a variable, you can directly enter in the xhr.open();

            let method = 'post';     // method is stored in a variable, (clean code practice)

            xhr.open(method, url, true);

            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');   // during post request , you also have to set content type in the headers


            let data = 'title=newPost&body=Body';

            // let data = `userName=${username}&userInterest=${interest}`;

            xhr.send(data);

            xhr.onload = function () {
                console.log(this.responseText)

                console.log(xhr.status)  // 201, (a resourse is created)
            }

        }


        // the data in your XMLHttpRequest is sent in the form of a string. 
        // Specifically, it is a "URL-encoded string".

        // let data = 'title=newPost&body=Body';

        // This data variable is a string that encodes key-value pairs. Each key-value pair is separated by an &, and within each pair, the key and value are separated by an '=' sign


        // How URL - Encoding Works ?

        // Key - Value Pairs : In the string 'title=newPost&body=Body', 'title' is a key with the value 'newPost', and 'body' is a key with the value 'Body'.

        // String Format: The entire data payload is a single string.



















        

         //JSON FORMAT

        // To send data as JSON using XMLHttpRequest, you need to do the following.

        // Set the Content-Type header to application/json.
        // Convert the data object to a JSON string using JSON.stringify().
        // Send the JSON string as the request body.
        // BTW code is copied from chatGPT


        function clickEventFunc() {
            let xhr = new XMLHttpRequest();

            let url = 'https://jsonplaceholder.typicode.com/posts';
            let method = 'POST';

            xhr.open(method, url, true);

            // Set the Content-Type header to application/json
            xhr.setRequestHeader('Content-Type', 'application/json');

            // Define the data object
            let data = {
                title: 'newPost',
                body: 'Body'
            };

            // Convert the data object to a JSON string
            let jsonData = JSON.stringify(data);

            // Send the JSON string
            xhr.send(jsonData);

            xhr.onload = function () {
                // Log the response text to the console
                console.log(this.responseText);
                // console.log(JSON.parse(this.responseText)); // this is how to convert into preffered format (object)
            };

            // Optionally, handle errors
            xhr.onerror = function () {
                console.error('Request failed');
            };
        }
        
    </script>
    
    
</body>
</html>
